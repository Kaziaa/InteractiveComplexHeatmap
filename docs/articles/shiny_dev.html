<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functions for Shiny app development • InteractiveComplexHeatmap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Functions for Shiny app development">
<meta property="og:description" content="InteractiveComplexHeatmap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">InteractiveComplexHeatmap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.10.1001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/InteractiveComplexHeatmap.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/decoration.html">Decorations on heatmaps</a>
    </li>
    <li>
      <a href="../articles/implementation.html">How interactive complex heatmap is implemented</a>
    </li>
    <li>
      <a href="../articles/interactivate_indirect.html">Interactivate indirect use of pheatmap(), heatmap.2() and heatmap()</a>
    </li>
    <li>
      <a href="../articles/shiny_dev.html">Functions for Shiny app development</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/InteractiveComplexHeatmap/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="shiny_dev_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Functions for Shiny app development</h1>
                        <h4 class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 class="date">2021-03-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/InteractiveComplexHeatmap/blob/master/vignettes/shiny_dev.Rmd"><code>vignettes/shiny_dev.Rmd</code></a></small>
      <div class="hidden name"><code>shiny_dev.Rmd</code></div>

    </div>

    
    
<style>
p {
    margin: 1em 0;
}
</style>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p><code><a href="../reference/htShiny.html">htShiny()</a></code> can export heatmaps as a stand-alone Shiny app. <strong>InteractiveComplexHeatmap</strong> also provides two functions for integrating the interactive heatmap widgets into other Shiny apps. The two functions are:</p>
<ul>
<li>
<code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code>: for building UI on the client side.</li>
<li>
<code><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap()</a></code>: for processing on the sever side.</li>
</ul>
<p>The usage is simple. Following is an example that you can directly copy and paste to your R session.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap">ComplexHeatmap</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/InteractiveComplexHeatmap">InteractiveComplexHeatmap</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/">shiny</a></span><span class="op">)</span>

<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h3</a></span><span class="op">(</span><span class="st">"My first interactive ComplexHeatmap Shiny app"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">ht</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p><img src="https://jokergoo.github.io/images/app_demo1.png" width="100%" style="display: block; margin: auto;"></p>
<p>You can also put multiple interactive heatmaps widgets in a single Shiny app, but this time you must assign a “<strong>heatmap ID</strong>” for each one, so that <code><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap()</a></code> can find the correct heatmap to respond. The heatmap ID should start with letters.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">m</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">ht1</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">m</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">ht2</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h3</a></span><span class="op">(</span><span class="st">"The first heatmap"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="st">"heatmap_1"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">hr</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h3</a></span><span class="op">(</span><span class="st">"The second heatmap"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="st">"heatmap_2"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">ht1</span>, <span class="st">"heatmap_1"</span><span class="op">)</span>
    <span class="fu"><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">ht2</span>, <span class="st">"heatmap_2"</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p><img src="https://jokergoo.github.io/images/app_demo2.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="customize-the-widgets" class="section level2">
<h2 class="hasAnchor">
<a href="#customize-the-widgets" class="anchor"></a>Customize the widgets</h2>
<p>There are three main components in the interactive heatmap UI, <em>i.e.</em>, the orignal heatmap, the sub-heatmap and an output that shows information of the clicked cell or the selected sub-heatmap. The original heatmap and sub-heatmap components can be resized by dragging the two boxes, but still, <code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code> provides arguments of <code>width1</code>, <code>width2</code>, <code>height1</code> and <code>height2</code> to control the initial sizes of the two components. They can be manually set to make sure the heatmap is well visible, e.g. in <code><a href="../reference/htShiny.html">htShiny(2.2)</a></code>.</p>
<p>The layout of the three components are controlled by the argument <code>layout</code>. It supports following layouts. Note the values are in a special format to help to understand the layout, where the symbol <code>"-"</code> corresponds to horizontal arrangment and <code>"|"</code> corresponds to vertical arrangement.</p>
<ul>
<li>
<code>"(1-2)|3"</code>: Heatmap and sub-heatmap are in a same row, and output is in a second row. This is the default layout.</li>
<li>
<code>"1|(2-3)"</code>: Heatmap is in a single row, while sub-heatmap and output are in a second row.</li>
<li>
<code>"1-2-3"</code>: All three components are in a same row.</li>
<li>
<code>"1|2|3"</code>: Each component is in a single row.</li>
<li>
<code>"1-(2|3)"</code>: Being different from the other four layouts, this is a two-column layout. Heatmap is in a sigle column. Sub-heatmap and output are vertically aligned and the two are in the second column. An example can be found at <code><a href="../reference/htShinyExample.html">htShinyExample(4.1)</a></code>.</li>
</ul>
<p>With different layouts, different default values are assigned to widths and heights of the three components to make sure they are well aligned.</p>
<p>By default, to get the information of a single cell in the heatmap, a <code>"click"</code> action is used. In <code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code>, the action can also be set to <code>"hover"</code> or <code>"dblclick"</code>. The example in <code><a href="../reference/htShinyExample.html">htShinyExample(1.8)</a></code> demonstrates usages of these three actions.</p>
<p>The initial style of the brush can be specified by <code>brush_opt</code> argument. The value should be a list and the value will be sent to <code><a href="https://rdrr.io/pkg/shiny/man/brushOpts.html">shiny::brushOpts()</a></code>. Note, the style of the brush can also be manually adjusted in the web page of the Shiny app.</p>
<p>The argument <code>response</code> can be set as one of <code>"click"</code>, <code>"hover"</code>, <code>"dblclick"</code> and <code>"brush"</code> to only respond to one event on heatmap. E.g. if <code>response</code> is set to <code>"click"</code>, there will be no response for the “brush event” in the interactive heatmap, also the sub-heatmap component is removed from the app. Please go to Section <a href="InteractiveComplexHeatmap.html#only-respond-to-one-event">“Only respond to one event”</a> for examples.</p>
</div>
<div id="work-with-r-markdown-documents" class="section level2">
<h2 class="hasAnchor">
<a href="#work-with-r-markdown-documents" class="anchor"></a>Work with R Markdown documents</h2>
<p>It is very straightforward to integrate <strong>InteractiveComplexHeatmap</strong> in an interactive R Markdown document, just in the same way of integrating normal Shiny widgets. Following is an example and you can run a real interactive document with heatmaps by <code><a href="../reference/htShinyExample.html">htShinyExample(7.1)</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "InteractiveComplexHeatmap in an Rmarkdown document"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Zuguang Gu"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "16/12/2020"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span><span class="co"> html_document</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="an">runtime:</span><span class="co"> shiny</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="in">library(InteractiveComplexHeatmap)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="in">m = matrix(rnorm(100*100), 100)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="in">ht = Heatmap(m)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="in">ui = fluidPage(</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="in">    InteractiveComplexHeatmapOutput()</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="in">server = function(input, output, session) {</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="in">    makeInteractiveComplexHeatmap(input, output, session, ht)</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="in">shiny::shinyApp(ui, server)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p><img src="https://jokergoo.github.io/images/rmarkdown.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="self-define-the-output" class="section level2">
<h2 class="hasAnchor">
<a href="#self-define-the-output" class="anchor"></a>Self-define the output</h2>
<p>Both the click and brush actions on the heatmap trigger an output below the heatmaps. The output gives the information of which row(s) and columns(s) are selected by users. The reponse for the two actions can be self-defined.</p>
<p>In <code><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap()</a></code>, there are two arguments <code>click_action</code> and <code>brush_action</code> which accept self-defined functions and define how to respond after the heatmap is clicked or brushed. The input for the two functions should accept two arguments, one is a <code>DataFrame</code> object which contains the information of which row(s) and columns(s) are selected by users, and the second argument should always be <code>output</code> which is used in the Shiny app.</p>
<p>To use <code>click_action</code> or <code>brush_action</code>, a <code>htmlOutput</code> (or other similar <code>*Output</code>) should be first set up in the UI, then the Shiny application knows where to update the output. The output UI can replace the default output by directly assigning to argument <code>output_ui</code> in <code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span>output_ui <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">htmlOutput</a></span><span class="op">(</span><span class="st">"info"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Or to create a new output UI independent to the interactive heatmap widget:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">htmlOutput</a></span><span class="op">(</span><span class="st">"info"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>The <code>click_action</code> or <code>brush_action</code> is basically defined as follows (assume the ID set in <code><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">htmlOutput()</a></code> is <code>"info"</code>):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">output</span><span class="op">[[</span><span class="st">"info"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>  <span class="co"># or output$info = ...</span>
        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># have not clicked into the heatmap body</span>
            <span class="va">...</span>
        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
            <span class="va">...</span>
        <span class="op">}</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>If users didn’t click or brush inside the heatmap body (e.g. clicked in the dendrograms), <code>df</code> that is passed to the functions will be <code>NULL</code>. Users might need to perform a sanity check here and print specific output when the heatmap was not selected.</p>
<p>The format of <code>df</code> is slightly different between click and brush. If it is a click action, <code>df</code> has the same format as the returned object of <code><a href="../reference/selectPosition.html">selectPosition()</a></code> function, which looks like follows. It always has one row.</p>
<pre><code>## DataFrame with 1 row and 6 columns
##       heatmap                  slice row_slice column_slice row_index
##   &lt;character&gt;            &lt;character&gt; &lt;numeric&gt;    &lt;numeric&gt; &lt;integer&gt;
## 1       mat_a mat_a_heatmap_body_1_2         1            2         9
##   column_index
##      &lt;integer&gt;
## 1            1</code></pre>
<p>If it is a brush action, <code>df</code> has the same format as the returned object of <code><a href="../reference/selectArea.html">selectArea()</a></code> function, which looks like in the following chunk. Each line contains row and column indices of the selected sub-matrix in a specific heatmap slice of a specific heatmap.</p>
<pre><code>## DataFrame with 4 rows and 6 columns
##       heatmap                  slice row_slice column_slice     row_index
##   &lt;character&gt;            &lt;character&gt; &lt;numeric&gt;    &lt;numeric&gt; &lt;IntegerList&gt;
## 1       mat_a mat_a_heatmap_body_1_2         1            2     7,5,2,...
## 2       mat_a mat_a_heatmap_body_2_2         2            2           6,3
## 3       mat_b mat_b_heatmap_body_1_1         1            1     7,5,2,...
## 4       mat_b mat_b_heatmap_body_2_1         2            1           6,3
##    column_index
##   &lt;IntegerList&gt;
## 1     2,4,1,...
## 2     2,4,1,...
## 3     1,2,3,...
## 4     1,2,3,...</code></pre>
<p>Note as demonstrated above, the values in column <code>row_index</code> and <code>column_index</code> might be duplicated due to that the selected heatmap slices are in a same row slice or column slice, <em>e.g.</em>, in previous example, the first and the third rows correspond to selection in the first row slice, but in the two column slices respectively, so they have the same value for <code>row_index</code>. thus, to safely get the row indices and column indices of the selected heatmap, users might need to perform:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">row_index</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">column_index</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Or use the helper functions:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/all_row_indices.html">all_row_indices</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="../reference/all_column_indices.html">all_column_indices</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<p>If <code>action</code> in <code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code> is set to <code>"hover"</code> or <code>"dblclick"</code>, the corresponding argument for action is <code>hover_action</code> or <code>dblclick_action</code>. The usage is exactly the same as <code>click_action</code>.</p>
<p>In the following example, in the UI, I add a new <code>htmlOutput</code> with ID <code>info</code>. On the sever side, I define <code>click_action</code> to print a styled text and define <code>brush_action</code> to print the table of the selected rows and columns from the heatmap.</p>
<p>You can also run the following example simply by <code><a href="../reference/htShinyExample.html">htShinyExample(5.2)</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/GetoptLong">GetoptLong</a></span><span class="op">)</span>  <span class="co"># for the qq() function which does variable intepolation</span>
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/cola/man/rownames-dispatch.html">rownames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/cola/man/colnames-dispatch.html">colnames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">m</span>, show_row_names <span class="op">=</span> <span class="cn">FALSE</span>, show_column_names <span class="op">=</span> <span class="cn">FALSE</span>, row_km <span class="op">=</span> <span class="fl">2</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span>output_ui <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">htmlOutput</a></span><span class="op">(</span><span class="st">"info"</span><span class="op">)</span><span class="op">)</span>,
<span class="op">)</span>

<span class="va">click_action</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">output</span><span class="op">[[</span><span class="st">"info"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
        <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GetoptLong/man/qq.html">qq</a></span><span class="op">(</span><span class="st">"&lt;p style='background-color:#FF8080;color:white;padding:5px;'&gt;You have clicked on heatmap @{df$heatmap}, row @{df$row_index}, column @{df$column_index}&lt;/p&gt;"</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span><span class="op">)</span>
<span class="va">brush_action</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">row_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">row_index</span><span class="op">)</span><span class="op">)</span>
    <span class="va">column_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">column_index</span><span class="op">)</span><span class="op">)</span>
    <span class="va">output</span><span class="op">[[</span><span class="st">"info"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
        <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="va">row_index</span>, <span class="va">column_index</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span>, position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">ht</span>,
        click_action <span class="op">=</span> <span class="va">click_action</span>, brush_action <span class="op">=</span> <span class="va">brush_action</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p><img src="https://jokergoo.github.io/images/customize_output.png" width="100%" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/htShinyExample.html">htShinyExample(5.3)</a></code> gives another scenario where the output needs to be self-defined. In that example, an gene expression matrix is visualized and clicking on the heatmap will print the corresponding gene and some other annotations related to this gene (e.g. the corresponding gene symbol, RefSeq IDs and UniProt IDs). Run <code><a href="../reference/htShinyExample.html">htShinyExample(5.3)</a></code> to see how this is implemented.</p>
<p><img src="https://jokergoo.github.io/images/customize_output2.png" width="100%" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/htShinyExample.html">htShinyExample(5.4)</a></code> gives an example where the heatmap visualizes correlations of a list of Gene Ontology terms (The plot is generated by <a href="https://bioconductor.org/packages/simplifyEnrichment/">the <strong>simplifyEnrichment</strong> package</a>). In this example, the click and brush actions are self-defined so that the selected GO IDs as well as their detailed descriptions are printed.</p>
<p><img src="https://jokergoo.github.io/images/customize_output3.png" width="100%" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/htShinyExample.html">htShinyExample(5.5)</a></code> links selected differential genes to the MA plot in a DESeq2 analysis, where the MA plot is implemented as the “output”.</p>
<p><img src="https://jokergoo.github.io/images/deseq2.gif" width="100%" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/htShinyExample.html">htShinyExample(5.6)</a></code> visualizes an correlation heatmap where clicking on the cell generates a scatter plot of the two corresponding variables.</p>
<p><img src="https://jokergoo.github.io/images/corrheatmap.gif" width="100%" style="display: block; margin: auto;"></p>
<p>Instead of occupying static space, the output component can be floated to the mouse positions by setting <code>output_ui_float = TRUE</code> so that clicking, hovering or brushing from the heatmap opens a frame that contains the output. There are two examples: <code><a href="../reference/htShinyExample.html">htShinyExample(9.1)</a></code> and <code><a href="../reference/htShinyExample.html">htShinyExample(9.2)</a></code>. The demonstration is as follows:</p>
<p><img src="https://jokergoo.github.io/images/float1.gif" width="100%" style="display: block; margin: auto;"></p>
<p>As will be explained in <a href="shiny_dev.html">the vignette “Functions for Shiny app development”</a>, the output can be self-defined to put customized information. The self-defined output can also be floated:</p>
<p><img src="https://jokergoo.github.io/images/float2.gif" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="dynamically-generate-interactive-heatmap-widget" class="section level2">
<h2 class="hasAnchor">
<a href="#dynamically-generate-interactive-heatmap-widget" class="anchor"></a>Dynamically generate interactive heatmap widget</h2>
<p>In previous examples, the heatmaps are already generated before making the interactive app. There are also scenarios where the heatmaps are generated on the fly, e.g. when the matrix is dynamically generated in the middle of an analysis. There might be following scenarios:</p>
<ol style="list-style-type: decimal">
<li>The matrix is dynamically generated, e.g. the dimension of the matrix or subset of rows and columns are dynamically selected.</li>
<li>The heatmaps are dynamically configurated, e.g. the method for clustering or for calculating distance is dynamically selected.</li>
<li>The heatmap annotations are dynamically selected.</li>
<li>If there are multiple heatmaps, which heatmaps are going to be drawn is dynamically selected.</li>
</ol>
<p>I first demonstrate an use of <code><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap()</a></code>. In the following example, the matrix is reordered by a user-selected column:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html">sliderInput</a></span><span class="op">(</span><span class="st">"column"</span>, label <span class="op">=</span> <span class="st">"Which column to order?"</span>, 
        value <span class="op">=</span> <span class="fl">1</span>, min <span class="op">=</span> <span class="fl">1</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/cola/man/rownames-dispatch.html">rownames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>
    <span class="fu"><a href="https://rdrr.io/pkg/cola/man/colnames-dispatch.html">colnames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>

    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">column</span>, <span class="op">{</span>
        <span class="va">order</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span>, <span class="va">input</span><span class="op">$</span><span class="va">column</span><span class="op">]</span><span class="op">)</span>
        <span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="va">order</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, 
            cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
        <span class="fu"><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">ht</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>A similar but slightly complex example is as follows. It can be run by <code><a href="../reference/htShinyExample.html">htShinyExample(6.2)</a></code>.</p>
<p><img src="https://jokergoo.github.io/images/dynamic_widget4.gif" width="100%" style="display: block; margin: auto;"></p>
<p>In the first example, the interactive heatmap is already generated when the Shiny app is loaded. There is a second scenario where the complete interactive heatmap widget is dynamically generated and inserted into the HTML document. There are two other functions <code><a href="../reference/InteractiveComplexHeatmapModal.html">InteractiveComplexHeatmapModal()</a></code> and <code><a href="../reference/InteractiveComplexHeatmapWidget.html">InteractiveComplexHeatmapWidget()</a></code> which have very similar behaviors. These two functions are normally put inside e.g. <code><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">shiny::observeEvent()</a></code> or <code><a href="https://rdrr.io/pkg/shiny/man/observe.html">shiny::observe()</a></code> and they generate UI as well as render the interactive heatmaps.</p>
<p>First I will introduce the usage of <code><a href="../reference/InteractiveComplexHeatmapModal.html">InteractiveComplexHeatmapModal()</a></code>. In the following example, there is only an action button in the UI, and in the server function, <code><a href="../reference/InteractiveComplexHeatmapModal.html">InteractiveComplexHeatmapModal()</a></code> is called when receiving an <code>input$show_heatmap</code> signal. This example can also be run by <code><a href="../reference/htShinyExample.html">htShinyExample(6.3)</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span><span class="op">(</span><span class="st">"show_heatmap"</span>, <span class="st">"Generate_heatmap"</span><span class="op">)</span>,
<span class="op">)</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>
    <span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>

    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">show_heatmap</span>, <span class="op">{</span>
        <span class="fu"><a href="../reference/InteractiveComplexHeatmapModal.html">InteractiveComplexHeatmapModal</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">ht</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>As shown in the following figure, <code><a href="../reference/InteractiveComplexHeatmapModal.html">InteractiveComplexHeatmapModal()</a></code> will open an “modal” which includes the interactive heatmap.</p>
<p><img src="https://jokergoo.github.io/images/dynamic_widget.gif" width="100%" style="display: block; margin: auto;"></p>
<p>In the next example (<code><a href="../reference/htShinyExample.html">htShinyExample(6.4)</a></code>), a different heatmap is generated according to user’s selection.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/radioButtons.html">radioButtons</a></span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"Select"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Numeric"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"Character"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span><span class="op">(</span><span class="st">"show_heatmap"</span>, <span class="st">"Generate_heatmap"</span><span class="op">)</span>,
<span class="op">)</span>

<span class="va">get_heatmap_fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">mat_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>
    <span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">mat_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">show_heatmap</span>, <span class="op">{</span>
        <span class="va">i</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select</span><span class="op">)</span>
        <span class="fu"><a href="../reference/InteractiveComplexHeatmapModal.html">InteractiveComplexHeatmapModal</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, 
            get_heatmap <span class="op">=</span> <span class="fu">get_heatmap_fun</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p><img src="https://jokergoo.github.io/images/dynamic_widget_radio_selection.gif" width="100%" style="display: block; margin: auto;"></p>
<p>The usage of <code><a href="../reference/InteractiveComplexHeatmapWidget.html">InteractiveComplexHeatmapWidget()</a></code> is very similar as <code><a href="../reference/InteractiveComplexHeatmapModal.html">InteractiveComplexHeatmapModal()</a></code>, except that now for <code><a href="../reference/InteractiveComplexHeatmapWidget.html">InteractiveComplexHeatmapWidget()</a></code>, user needs to allocate a place defined by <code><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">shiny::htmlOutput()</a></code> in UI, and later the interactive heatmap widget is put there.</p>
<p>I modify the previous example with <code><a href="../reference/InteractiveComplexHeatmapWidget.html">InteractiveComplexHeatmapWidget()</a></code>. Now in the UI, I add one line with <code><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">htmlOutput()</a></code> with ID <code>heatmap_output</code>, and this ID is set in <code><a href="../reference/InteractiveComplexHeatmapWidget.html">InteractiveComplexHeatmapWidget()</a></code> correspondingly.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span><span class="op">(</span><span class="st">"show_heatmap"</span>, <span class="st">"Generate_heatmap"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">htmlOutput</a></span><span class="op">(</span><span class="st">"heatmap_output"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>
    <span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">show_heatmap</span>, <span class="op">{</span>
        <span class="fu"><a href="../reference/InteractiveComplexHeatmapWidget.html">InteractiveComplexHeatmapWidget</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">ht</span>, output_id <span class="op">=</span> <span class="st">"heatmap_output"</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>The app looks like follows:</p>
<p><img src="https://jokergoo.github.io/images/dynamic_widget2.gif" width="100%" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/InteractiveComplexHeatmapModal.html">InteractiveComplexHeatmapModal()</a></code> and <code><a href="../reference/InteractiveComplexHeatmapWidget.html">InteractiveComplexHeatmapWidget()</a></code> all accept an argument <code>js_code</code> where customized JavaScript code can be inserted after the interactive UI. This is sometimes useful. In previous example where the heatmap widget is triggered by clicking on the action button, every time when clicking on the button, the widget is regenerated although the heatmaps are actually the same. Actually we can change the behavior of the button that from the second click it just switches the visibility of the heatmap widget. Note here we also need to set <code>cancel_action = "hide"</code> so that the heatmap UI is not removed from HTML document after it is closed.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span><span class="op">(</span><span class="st">"show_heatmap"</span>, <span class="st">"Generate_heatmap"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">htmlOutput</a></span><span class="op">(</span><span class="st">"heatmap_output"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>
    <span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">show_heatmap</span>, <span class="op">{</span>
        <span class="fu"><a href="../reference/InteractiveComplexHeatmapWidget.html">InteractiveComplexHeatmapWidget</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">ht</span>, 
            output_id <span class="op">=</span> <span class="st">"heatmap_output"</span>, cancel_action <span class="op">=</span> <span class="st">"hide"</span>,

            js_code <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">heatmap_id</span><span class="op">)</span> <span class="op">{</span>
                <span class="st">"$('#show_heatmap').click(function() {
                    $('#heatmap_output').toggle('slow');
                }).text('Show/hide heatmap').
                   attr('id', 'show_heatmap_toggle');
            "</span><span class="op">}</span>
        <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p><img src="https://jokergoo.github.io/images/dynamic_widget3.gif" width="100%" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
